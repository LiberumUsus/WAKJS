String.prototype.wakwrap=function(t,n){if(!t)return this;if(!n){let e=t.split(" ");t=e[0],n=e[1],n||(n="")}return t+this+n},String.prototype.wakfirst=function(t,n){if(!t||!t.length)return-1;(!n||typeof n!="number")&&(n=0);for(let e=n;e<this.length;e++)if(t.includes(this[e]))return e};class $WUtils{static WAK_APREF="wak_";static WAK_TYPES=$WUtils.WAK_APREF+"types";static WAK_FUNC=$WUtils.WAK_APREF+"action";static WAK_ARGS=$WUtils.WAK_APREF+"args";static WAK_REFS=$WUtils.WAK_APREF+"refs";static WAK_EVENT=$WUtils.WAK_APREF+"event";static WAK_EVENTID=$WUtils.WAK_APREF+"eventid";static isDefined(e){return e!=null}static isType(e,t){return e!==void 0&&typeof e===t}static isString(e){return $WUtils.isType(e,"string")}static isBoolean(e){return $WUtils.isType(e,"boolean")}static isNumber(e){return $WUtils.isType(e,"number")}static isFunc(e){return $WUtils.isType(e,"function")}static isObject(e){return $WUtils.isType(e,"object")}static isArrayEmpty(e){return!$WUtils.isArray(e)||e.length<=0}static isArray(e,t){return!!e&&e instanceof Array&&(!$WUtils.isDefined(t)||!(e.length<=0)&&(typeof t=="object"||typeof t=="function"?e[0]instanceof t:typeof e[0]===typeof t))}static isElement(e){return e&&(e instanceof Element||e instanceof HTMLDocument||e instanceof Node)}static isEvent(e){return e&&e instanceof Event}static cloneToArray(e){let t=[];if($WUtils.isArray(e))e.forEach(e=>{if(typeof e=="object"){let n={};Object.assign(n,e),t.push(n)}else t.push(e)});else{let n={};Object.assign(n,e),t.push(n)}return t}static processElemForWAK(e){if(!$WUtils.isElement(e))return{types:[],funcArgs:[]};let t={},s=e.getAttribute($WUtils.WAK_TYPES);t.types=s?s.split(" "):[];let o=e.getAttribute($WUtils.WAK_FUNC);if(o){let e=$WUtils.strFuncToNameAndParams(o);t.func=e.refFunc,t.funcArgs=e.params}let i=e.getAttribute($WUtils.WAK_ARGS);t.funcArgs=i?i.split(","):!t.funcArgs?[]:t.funcArgs;let n=e.getAttribute($WUtils.WAK_REFS);if(n&&n.startsWith("{"))try{n=JSON.parse(n.replace("'",'"'))}catch{n=void 0}n&&(t.refs=n);let a=e.getAttribute($WUtils.WAK_EVENT);a&&(t.eventType=a);let r=e.getAttribute($WUtils.WAK_EVENTID);r&&(t.eventID=r);let c=JSON.stringify(t);return t.baseid=btoa(JSON.stringify(c)),t}static splitWithBoundings(e,t,n,s,o=1){if(n||(n=`'"`),s||(s=n),!$WUtils.isString(t)||!$WUtils.isString(n)||!$WUtils.isString(s))return t;let u=0;o||(u=-1);let a=!1,i=0,d=t.length,c=[],r=0,l=0;for(let u=0;u<e.length;u++){let h=e[u];if(i==d){let t=e.substring(r,u-d);t&&c.push(t),r=u}if(a){if(!o&&s.indexOf(h)==l||o&&s.indexOf(h)>-1){a=s.indexOf(h)<0;continue}}else l=n.indexOf(h),l>-1&&(a=!0);if(a){i=0;continue}i=h==t[i]?i+1:0}return r<e.length&&c.push(e.substring(r)),c}static strFuncToNameAndParams(e){if(!$WUtils.isString(e))return;let t=e.match(/([a-zA-Z]+)([(](.*)[)])?/);if(!t||t.length<=1)return{};let n={refFunc:void 0,params:[]};return t[1]&&(n.refFunc=t[1]),t[3]&&(n.params=$WUtils.splitWithBoundings(t[3],",")),n}static cssQueryMatch(e,t,n){switch(t){case"^":return e.startsWith(n);case"$":return e.endsWith(n);case"|":return e===n||e===n+"-";case"*":return e.includes(n);case"~":let t=e.split(" ");return t.includes(n);default:break}return!1}static queryAttribs(e,t){if(!$WUtils.isElement(e))return;t.startsWith("[")&&(t=t.substring(1)),t.endsWith("]")&&(t=t.substring(0,t.length-1));let s=t.split("="),n=s[0].match(/^(.*)([|*~^])$/);if(n=!n?[].concat(s[0]):[].concat(n.splice(1)),s.length==1){if(n.length>1){let t=[];for(let s=0;s<e.attributes.length;s++){let o=e.attributes[s];$WUtils.cssQueryMatch(o.name,n[1],n[0])&&t.push(o)}return t}return e.getAttribute(s[0])}else{let o="=";n.length==2&&(o=n[1]);let t=[];for(let o=0;o<e.attributes.length;o++){let i=e.attributes[o];if(i.name!==n[0])continue;$WUtils.cssQueryMatch(i.value,n[1],s[1])&&t.push(i)}return t}}static verifyElemMatchesQuery(e,t){let o=!1;if(!$WUtils.isElement(e)||!e.tagName)return!1;if(!$WUtils.isString(t))return!1;t=t.trim();let a=e.tagName.toLowerCase().trim(),s=-2,i=0;for(;s&&i<999999;){s=t.wakfirst(".[",s);let n=t.substring(0,s),r=t.substring(s);if(i==0&&a==n.toLowerCase()&&(o=!0,t=r,s=t.wakfirst(".[",s),n=t.substring(0,s),r=t.substring(s)),n||(n=r),n.startsWith("."))o=e.classList.contains(n.substring(1));else if(n.startsWith("[")){o=!1;let i=t.wakfirst("]",s);if(!i)break;let n=t.substring(1,i).split("=");if(n.length==1&&e.hasAttribute(n[0])){o=!0;continue}let a=e.getAttribute(n[0]);if(!a)break;o=a==n[1].replaceAll("'","")}if(!o)break;t=r,i++}return i==0&&a==t||o}static ancestors(e,t,n){if(!$WUtils.isElement(e))return;let o=Number.MAX_VALUE,s=[],i=0;if($WUtils.isNumber(t)&&(o=t,t=void 0),$WUtils.isObject(n)||(n={}),n&&$WUtils.isNumber(n.limit)&&(o=n.limit),!$WUtils.isString(t))return s;do{if(e.parentNode&&s.push(e.parentNode),e.parentNode&&t&&$WUtils.verifyElemMatchesQuery(e.parentNode,t,n))break;i++}while((e=e.parentNode)&&i<o)return n.single?s[s.length-1]:s}static commonAncestor(e,t){if($WUtils.isElement(e)&&(e=$WUtils.ancestors(e,"html")),$WUtils.isElement(t)&&(t=$WUtils.ancestors(t,"html")),!$WUtils.isArray(e,HTMLElement))return void 0;if(!$WUtils.isArray(t,HTMLElement))return void 0;let n=0,s=void 0,o=t.length;if(e.includes(t[n]))return{common:t[n],index:n};for(;!e.includes(t[n++]);)if(n>=o)break;return s=e.includes(t[n-1])?t[n-1]:void 0,{common:s,index:n}}static nearestRelative(e,t){if(!$WUtils.isElement(e)||!$WUtils.isString(t))return void 0;let o=void 0,i=$WUtils.ancestors(e,"body"),r=document.querySelectorAll(t),n=[],a=i.length+1,s=-1;return r.forEach(e=>{let t=$WUtils.commonAncestor(i,e);n.push(e),a>t.index&&(a=t.index,s=n.length-1)}),s>-1&&(o=n[s]),o}static randomString(e,t){if(!$W.isNumber(e))return void 0;let i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",a="012345679",l="!@#$%^&*(){}+?/=[]_`~",s="",r=0;t||(s=i+a),$W.isArray(t,"")&&(s+=t.flat().join("")),$W.isString(t)&&(s+=t);let c=s.length,o="";for(;r++<e;)o+=s.charAt(Math.floor(Math.random()*c));return o}static transMog={strArray:e=>$WUtils.isString(e)?e.split(" "):$WUtils.isArray(e,"")?e:void 0};static replaceChildrenByTemplate(e,t,n){e.replaceChildren(),$WUtils.createElementWithData(t,n,e,0)}static appendChildrenByTemplate(e,t,n){$WUtils.createElementWithData(t,n,e,0)}static createElementWithData(e,t,n,s){if(typeof e!="object")return void 0;if(typeof t!="object")return void 0;if(typeof s!="number")return void 0;let o=n,i=o,a=e instanceof Array,r=t instanceof Array;return r||(t=[t]),(s<0||s>t.length)&&(t=[{}],s=0),a?(e.forEach(e=>{$WUtils.createElementWithData(e,t,n,s)}),o):(Object.keys(e).forEach(n=>{let a=e[n],c=n.match(/^(_.)|(._)/);if(c)if(n==="_loop"){let e=a;a._source&&a._template&&(e=a._template,t=getVariableValue(a._source,t[s]));for(var r=s;r<t.length;r++)$WUtils.createElementWithData(e,t,o,r)}else if(n==="_ref"){let n=$WUtils.getVariableValue(a,t[s]);if(!n)return;let e=window[n];if(!e){let t=n.match(/^[a-zA-Z]+$/)[0];t&&(e=eval(t))}e&&$WUtils.createElementWithData(e,t,o,s)}else{if(!i)return void 0;$WUtils.modElement(i,e,t[s],s)}else{let c=n.match(/([a-zA-Z]+)[0-9]+/);c!==null&&(n=c[1]);let e=$WUtils.createElements(n,!0),r=void 0;e&&(o?o.appendChild($WUtils.getOldest(e)):o=$WUtils.getOldest(e),i=e,r=e,typeof a=="object"&&(r=$WUtils.createElementWithData(a,t,r,s)))}}),o)}static getVariableValue(e,t){let s=e.match(/([$][^$, ]*)/g),n=e;return s.forEach(e=>{let o=void 0;if(typeof t=="object"?o=$WUtils.extractFromObj(t,e.substring(1)):typeof t=="string"&&(o=t),o instanceof Array&&s.length==1){n=o;return}typeof o=="object"&&(o=void 0),n=n.replace(e,o||"")}),n}static getOldest(e){if(e instanceof HTMLElement){let t=$WUtils.getOldest(e.parentElement);return t||e}}static modElements(e,t,n,s){if(e instanceof NodeList&&(e=Array.from(e)),!$WUtils.isArray(e))return;e.forEach(e=>{$WUtils.modElement(e,t,n,s)})}static#replaceStringWithDataVars(e,t){let n=e.match(/([$][^$, ]*)/g);return n.forEach(n=>{let s=void 0;typeof t=="object"?s=$WUtils.extractFromObj(t,n.substring(1)):typeof t=="string"&&(s=t),typeof s=="object"&&(s=void 0),e=e.replace(n,s||"")}),e}static#modByObject(e,t,n){let s=e.getAttribute(t);if(t=="_style"){let t=n.style;if(!t)return;let o=n.off,s=e.style[t];if(s===void 0)return;n.toggle?e.style[t]=s==n.on||s==n.default?o??"":n.on:e.style[t]=n.on??o??""}else t=="a_class"&&(n.toggle?n.off&&e.classList.contains(n.on)?(e.classList.removeClass(n.on),e.classList.addClass(n.off)):n.off?(e.classList.addClass(n.on),e.classList.removeClass(n.off)):e.classList.toggle(n.on):(n.on&&e.classList.addClass(n.on),n.off&&e.classList.removeClass(n.off)))}static modElement(e,t,n,s){if(typeof t!="object")return void 0;let o=["_text","_index","_event","a_value","a_type","a_style","a_placeholder","a_class","a_name","a_href","a_id","_style"];(e instanceof HTMLElement||e instanceof Node)&&Object.keys(t).forEach(i=>{if(o.includes(i)||i.startsWith("a_wak_")){let o=t[i];if($WUtils.isString(o))if(o.includes("$"))o=$WUtils.#replaceStringWithDataVars(o,n);else if(o=="_index")o=s;else if(i=="_event"){let s=o.match(/([a-zA-Z]+([:]))?([a-zA-Z]*)/);if(!s)return;let t=s[1];t||(t="click"),t&&(t=t.replaceAll(":",""));let n=s[3];if(!n||!window[n])return;if(typeof window[n]!="function")return;e.addEventListener(t,window[n])}let a=void 0,r=i;switch(i.startsWith("a_")&&(a=i.substring(2),i="attr"),o="_value"==o?n:o,i){case"_text":e.textContent=o;break;case"_style":case"attr":(a||i=="_style")&&(o!==void 0?$WUtils.isObject(o)?$WUtils.#modByObject(e,r,o):e.setAttribute(a,o):e.removeAttribute(a));break}}})}static createElements(e,t=!1){if(typeof e!="string")return void 0;let o=e.split("."),n=void 0,s=void 0;return o.forEach(e=>{let t=$WUtils.createElement(e);if(t)n?s.appendChild(t):n=t;else return void 0;s=t}),t?s:n}static createElement(e){let t=["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","menu","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rp","rt","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],n=["button","datalist","fieldset","form","input","label","legend","meter","optgroup","option","output","progress","select","textarea"];return t.includes(e.toLowerCase())?document.createElement(e.toLowerCase()):n.includes(e.toLowerCase())?document.createElement(e.toLowerCase()):void 0}static extractFromObj(e,t){typeof t=="string"&&(t.startsWith(".")&&(t=t.substring(1)),t=t.split("."));var o,n=t[0];let i=n.indexOf("["),s=t.length>1?t.splice(1):[];if(i>-1){let e=n.replaceAll("[",".").replaceAll("]","");e=e.startsWith(".")?e.substring(1):e;let t=e.split(".");n=t[0],s=t.splice(1).concat(s)}if(o=e[n],n.startsWith("{")){let t=n.match(/{(\d+)}/)[1];t&&(o=e[Object.keys(e)[t]])}return o===void 0?void 0:s.length>0?$WUtils.extractFromObj(e[n],s):o}}class WAKjs{static#_autoWires=new Map;static#_actions=new Map;static#_kFunctions=new Map;static#_actionGroups=new Map;static#_refSearchs=new Map;static#_eventFuncMap=new Map;static#_eventFuncs=[];static getActionGroup(e){return $W.isString(e)?WAKjs.#_actionGroups.has(e)?WAKjs.#_actionGroups.get(e):void 0:void 0}static eventEnable(e,t,n){if(!$WUtils.isElement(e)||!$WUtils.isString(t))return;let s=WAKjs.#_eventFuncMap.get(e.wak_id);if(!s)return;n?e.addEventListener(s.type,WAKjs.#_eventFuncs[s.index]):e.removeEventListener(s.type,WAKjs.#_eventFuncs[s.index]),s.enabled=n,WAKjs.#_eventFuncMap.set(e.wak_id,s)}static eventEnabled(e,t){if(!$WUtils.isElement(e)||!$WUtils.isString(t))return;let n=WAKjs.#_eventFuncMap.get(e.wak_id);return!!n&&n.enabled}static actionEnable(e,t){if(!$WUtils.isString(e))return;let n=WAKjs.#_actions.get(e);if(!n)return;n.enabled=!!t}static actionEnabled(e){if(!$WUtils.isString(e))return;let t=WAKjs.#_actions.get(e);if(!t)return;return!!t.enabled}static functionEnable(e,t){if(!$WUtils.isString(e))return;let n=WAKjs.#_kFunctions.get(e);if(!n)return;n.enabled=!!t}static functionEnabled(e){if(!$WUtils.isString(e))return;let t=WAKjs.#_kFunctions.get(e);if(!t)return;return!!t.enabled}static#processQueries(e){if(!e.queries&&$WUtils.isString(e.action)&&(e.queries=e.action),!e.queries)return;let t=$WUtils.isArray(e.queries)?e.queries:[e.queries];e.refs=[],t.forEach(t=>{let s=$WUtils.isString(t)?{name:t}:t;if(!$WUtils.isObject(s))return;if(!s.name)return;let n=WAKjs.#_refSearchs.get(s.name);if(!n)return;n.refs=[],n.useParamCache||(n.params=void 0),n.refs=e.refs,s.paramRefs&&(n.paramRefs=s.paramRefs),s.params&&(n.params=s.params),n.paramRefs&&WAKjs.#collectParams(n,e.elem,e.event),n.params||(n.params=[e.event.currentTarget]),e.refs||(e.refs=[]);try{let t=n.action(...n.params);n.expand?e.refs=e.refs.concat(t):e.refs.push(t)}catch(e){console.log(e)}})}static#processActionState(e){let t=e.actionType&&$WUtils.isNumber(e.actionType)?e.actionType:0;if(e.currentAction={},$WUtils.isFunc(e.action))return;if($WUtils.isObject(e.action)&&$WUtils.isFunc(e.action.refFunc)&&(e.action=e.action.enabled?e.action.refFunc:void 0),!$WUtils.isString(e.action))return;if(e.action.startsWith("!")&&($WUtils.isFunc($WUtils[e.action.substring(1)])?e.action=$WUtils[e.action.substring(1)]:e.action=void 0),WAKjs.#_kFunctions.has(e.action)&&(!t||t==1)){let t=WAKjs.#_kFunctions.get(e.action);e.action=t.enabled?t.refFunc:void 0}let n=WAKjs.#_actions.get(e.action);n&&(!t||t==2)&&(e.action=n.enabled?n.action:void 0,e.currentAction=n)}static#finalizeParams(e){let t=[];return e.currentAction.passEvent&&(t=t.concat(e.event)),e.currentAction.passElem&&(t=t.concat(e.elem)),e.params&&(t=t.concat(e.params)),!e.params&&e.refs&&(t=t.concat(e.refs)),!e.params&&t.length==0&&(t=t.concat(e.elem)),t}static#simpleEventFunc=function(e){let t={results:[]},n=e.currentTarget;if(Object.assign(t,this.canister),t.event=e,t.elem=n,WAKjs.#processActionState(t),!$WUtils.isFunc(t.action))return;WAKjs.#processQueries(t),t.autoRefTape&&WAKjs.#processRefTape(t,t.results),t.paramRefs&&WAKjs.#collectParams(t,t.elem,t.event);let s=WAKjs.#finalizeParams(t);try{let e=WAKjs.makeFuncCall(t.action,s)}catch(e){console.log(e)}};static#standardEventFunc=function(e){let n=!1,t=this.canister,s=e.currentTarget;t.results=[],t.forEach(o=>{let i={};if(Object.assign(i,o),t.stopOnFail&&n)return;if(i.event=e,i.elem=s,WAKjs.#processActionState(i),!$WUtils.isFunc(i.action))return;if(WAKjs.#processQueries(i),i.preCalls&&!WAKjs.#makePreCalls(i))return;i.autoRefTape&&WAKjs.#processRefTape(i,t.results),i.paramRefs&&WAKjs.#collectParams(i,i.elem,i.event);let a=WAKjs.#finalizeParams(i);try{let e=WAKjs.makeFuncCall(i.action,a);t.results.push(e)}catch(e){console.log(e),n=!0}})};static call(e){if(!e)throw"No function";if(!WAKjs.#_kFunctions.has(e))throw"No function";let t=Array.from(arguments);t=t.splice(1);let n=WAKjs.#_kFunctions.get(e);if(!n)throw"Function undefined";if(!n.enabled)return;return n.refFunc(...t)}static registerFunction(e,t){return!!$WUtils.isString(e)&&!!$WUtils.isFunc(t)&&(WAKjs.#_kFunctions.set(e,{refFunc:t,enabled:!0}),!0)}static registerWire(e,t){if(!$WUtils.isString(e)||!$WUtils.isFunc(t))return;let n=e+"_"+$WUtils.randomString(10);WAKjs.#_autoWires.set(e,{wireID:n,refFunc:t})}static registerAction(e,t){if(!$WUtils.isString(e)||!$WUtils.isObject(t))return;t.enabled==void 0&&(t.enabled=!0),WAKjs.#_actions.set(e,t)}static registerSelector(e,t){if(!$WUtils.isString(e)||!$WUtils.isObject(t))return;WAKjs.#_refSearchs.set(e,t)}static#makePreCalls(e){if(!$WUtils.isObject(e))return;if($WUtils.isArrayEmpty(e.preCalls))return;let t=e.preCallSeq??Array.from({length:e.preCalls.length},(e,t)=>t);if(!$WUtils.isArray(t,1))return;let n=t.every(t=>{let n=e.preCalls[t],s=e.verifyCalls[t];if(!n||!$WUtils.isFunc(n))return!0;let o=n(e);return!s||!$WUtils.isFunc(s)||s(o)});return n}static#collectParams(e,t,n){if($WUtils.isArrayEmpty(e.paramRefs))return;e.params=[],e.paramRefs.forEach(s=>{let o=void 0;if(!$WUtils.isArray(s)||s.length<=1)return;let a=s[0],i=s[1];switch(a){case"f":case"function":if(!$WUtils.isFunc(i))return;o=i();break;case"v":case"value":o=i;break;case"attrib":if(!$WUtils.isElement(t)||!$WUtils.isString(i))return;o=t.getAttribute(i);break;case"event":if(!n||!$WUtils.isString(i))return;let s=$WUtils.extractFromObj(n,i);s!==void 0&&(o=s);break;case"elem":if(!t)return;o=t;break;case"ref":if(!$WUtils.isArray(e.refs)||!$WUtils.isNumber(i))return;i<0?o=e.refs:o=e.refs[i];break;case"group":if(!$WUtils.isString(i))return;o=$WAKjs.sourceGroups[i];break;default:return;break}if(o===void 0)return;$WUtils.isArray(o)||(o=[o]),e.params=e.params.concat(o)})}static#readQuery(e,t,n,s){let c={elem:s.element,event:s.event,target:s.event.target,document,window,t:s.event.target,e:s.element,v:s.event,d:s.document,w:s.window},i=[],r=t[n+1]=="a"||t[n+1]=="all",o=r?t[n+2]:t[n+1],a=!1;switch(t[n]){case"^":case"select":case"q":case"query":a=!0,o.startsWith("'")&&(o=o.substring(1)),o.endsWith("'")&&(o=o.substring(0,o.length-1)),r?i=e.querySelectorAll(o):i=e.querySelector(o);break;case"@":case"attrib":a=!0,i=e.getAttribute?e.getAttribute(o):void 0;break;case"tag":a=!0,i=e.getElementsByTagName?e.getElementsByTagName(o):void 0;break;case"classname":a=!0,i=e.getElementsByClassName?e.getElementsByClassName(o):void 0;break;case"s":case"sibling":i=e.nextElementSibling;break;case"p":case"parent":i=e.parentElement;break;case"child":let s=parseInt(o);if(isNaN(s))break;a=!0,i=e.children[s];break;default:e||(e=c[t[n]]),i=e;break}return n+=r?1:0,n+=a?1:0,[i,n]}static readSource(e,t,n,s,o,i){let a=e[t++];switch(a){case"~":case"tmp":a=s;break;case"r":case"ref":a=n.refs;break;case"R":case"result":a=i;break;default:a=o&&o.length>0?o:void 0}if(!a)return[void 0,t];let r=parseInt(e[++t]);return isNaN(r)?[a,--t]:[[a[r]],t]}static#processRefTape(e,t){if(!e)return;let o=$WUtils.isString(e.autoRefTape)?$WUtils.splitWithBoundings(e.autoRefTape," "):e.autoRefTape;if(!$WUtils.isArray(o))return;let s=[],r=void 0,i=void 0,c=void 0,a=void 0;t||(t=[]);for(var n=0;n<o.length;n++){let d=void 0,l=o[n];switch(l){case"2":case"to":let l=o[++n];switch(l){case"r":case"ref":e.refs||(e.refs=[]),a=e.refs,i||(i=s[s.length-1],c=!0);break;case"~":case"tmp":a=s;break;default:a=void 0;break}break;case"source":[i,n]=WAKjs.readSource(o,++n,e,s,r,t),c=!0;break;default:c=!1;let d=s[s.length-1];[r,n]=WAKjs.#readQuery(r,o,n,e),s.push(r);break}c&&a&&(a.push(i),i=void 0)}}static makeFuncCall(e,t){if(!$WUtils.isFunc(e)||!$WUtils.isArray(t))return;return e(...t)}static#verifyCall(){}static#concludeAction(){}static selfRegistrations(){WAKjs.registerAction("_actRegisterEventListener",{action:(e,t,n)=>{if(!$WUtils.isString(t)||!$WUtils.isString(n))return;let o={};$WUtils.isString(e)&&(o.autoRefTape=e);let s=$WUtils.isElement(e)?e:WAKjs.#processRefTape(o);if(!s||!s.addEventListener)return;let i=WAKjs.#_actions.get(n);if(!$WUtils.isFunc(i.refFunc))return;s.addEventListener(t,i.refFunc)}})}static autoWire(e){let n=e instanceof HTMLElement||e==window||e==document?e:document,o=n.querySelectorAll("[wak_types]");o.forEach(e=>{let t=$WUtils.processElemForWAK(e).types;t.forEach(t=>{if(WAKjs.#_autoWires.has(t)){let n=WAKjs.#_autoWires.get(t);try{n.refFunc(e,n.wireID)}catch(n){console.log("Failed to auto wire:"+e.tagName+" "+e.id+" type:"+t),console.log(n.message)}}})});let s=WAKjs.#_autoWires.keys(),t=s.next(),i=Number.MAX_VALUE,a=0;for(;!t.done&&a++<i;){let e=t.value;if(e.startsWith("!")){let n=document.querySelectorAll(e.substring(1));n.forEach(s=>{let o=WAKjs.#_autoWires.get(e);try{o.refFunc(s,o.wireID)}catch(e){console.log("Failed to autowire: "+t+" "+n),console.log(e.message)}})}t=s.next()}let r=n.querySelectorAll($WUtils.WAK_FUNC.wakwrap("[ ]"));r.forEach(e=>{let n=$WUtils.processElemForWAK(e);if(!n.func)return;let s=n.eventType??"click",t={};if(t.action=n.func,$WUtils.isString(t.action)){let e=!1;WAKjs.#_kFunctions.has(t.action)&&(t.action=WAKjs.#_kFunctions.get(t.action),e=!0),!e&&window[t.action]&&(t.action=window[t.action])}n.refs&&(t.autoRefTape=n.refs,t.paramRefs=[["ref",0]]),n.funcArgs&&(t.paramRefs||(t.paramRefs=[]),n.funcArgs.forEach(e=>{e==="this"?t.paramRefs.push(["elem",0]):e.startsWith("@")&&(t.autoRefTape+=" "+e)})),t.eventID=n.eventid??n.baseid,WAKjs.registerEventListener(e,s,t)})}static registerWithGroup(e,t,n){if(!e||!$WUtils.isString(t))return;if(!$WUtils.isObject(n))return;if(n.autoRefTape&&(n.element=e,n.event={},WAKjs.#processRefTape(n,void 0)),n.paramRefs?WAKjs.#collectParams(n,e,{}):n.params||(n.params=[].concat(e)),WAKjs.#_actionGroups.has(t)){let e=WAKjs.#_actionGroups.get(t);$WUtils.isArray(e)||(e=[].concat(e)),WAKjs.#_actionGroups.set(t,e.concat(n.params))}else WAKjs.#_actionGroups.set(t,n.params)}static unregisterEventAction(e,t,n){if(!e||!$WUtils.isString(t)||!$WUtils.isString(n))return;let s=WAKjs.#_actions.get(n);if(!s)return;e.removeEventListener(t,s.refFunc)}static#processTapeForEvent(e,t){$WUtils.isString(e)?(e={},e.action=t[2],e.queries=$WUtils.transMog.strArray(t[3])):t.length>3&&(e.action=t[3],e.queries=$WUtils.transMog.strArray(t[4]));let o=$WUtils.cloneToArray(e),n=[].concat(o),s=n[0].action!=void 0;if(!s&&$WUtils.isString(n[0].action)&&(s=WAKjs.#_kFunctions.has(n[0].action)),n.length<=0||!s)return;return n}static registerEventListener(e,t,n){if(!e||!$WUtils.isString(t))return;if(!$WUtils.isString(n)&&!$WUtils.isObject(n)&&!$WUtils.isArray(n))return;let i=void 0,s=-1,o=e.wak_id;if($WUtils.isString(o)&&WAKjs.#_eventFuncMap.has(o)){let e=WAKjs.#_eventFuncMap.get(o);e&&$WUtils.isNumber(e.index)&&(s=$WUtils.isFunc(WAKjs.#_eventFuncs[e.index])?e.index:-1)}if(s<0){let a=WAKjs.#processTapeForEvent(n,arguments);if(!a)return;a.length==1&&!a[0].preCalls?i=WAKjs.#simpleEventFunc.bind({canister:a[0]}):i=WAKjs.#standardEventFunc.bind({canister:a}),WAKjs.#_eventFuncs.push(i),s=WAKjs.#_eventFuncs.length-1,o||(o="!E"+s),WAKjs.#_eventFuncMap.set(o,{element:e,type:t,index:s,enabled:!0})}s>=0&&(e.addEventListener(t,WAKjs.#_eventFuncs[s]),e.wak_id=o)}}const $W=$WUtils,$ώ=$WUtils,$Ω=WAKjs;window.addEventListener("DOMContentLoaded",e=>{WAKjs.selfRegistrations(),WAKjs.autoWire()})